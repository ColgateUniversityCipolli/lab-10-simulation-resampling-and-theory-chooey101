library(tidyverse)
sim.study <- rbinom(n=1000, size=10000, prob=0.39) #Random binom sample
sim.study <- rbinom(n=10000, size=1000, prob=0.39) #Random binom sample
data <- tibble(x = sim.study)
View(data)
View(data)
R <- 1000
resamples <- tibble(p.hat = numeric(R))
for( i in 1:R){
curr.resample <- sample(x = data$x,
size = nrow(data),
replace = T)
# compute the stat on the resample
resamples$p.hat[i] <- mean(curr.resample)
}
View(resamples)
ggplot(resamples) +
geom_histogram(aes(x=x, y=after_stat(density)),
breaks=seq(1.4, 2.7,0.10),
color="grey")+
geom_hline(yintercept=0)+
theme_bw()+
xlab(bquote(p))+
ylab("Density")
ggplot(resamples) +
geom_histogram(aes(x=p.hat, y=after_stat(density)),
breaks=seq(1.4, 2.7,0.10),
color="grey")+
geom_hline(yintercept=0)+
theme_bw()+
xlab(bquote(p))+
ylab("Density")
ggplot(resamples) +
geom_histogram(aes(x=p.hat, y=after_stat(density)),
color="grey")+
geom_hline(yintercept=0)+
theme_bw()+
xlab(bquote(p))+
ylab("Density")
ggplot(resamples) +
geom_histogram(aes(x=p.hat, y=after_stat(density)),
color="grey")+
geom_density(color = "red", linewidth = 1) +
geom_hline(yintercept=0)+
theme_bw()+
xlab(bquote(p))+
ylab("Density")
ggplot(resamples) +
geom_histogram(aes(x=p.hat, y=after_stat(density)),
color="grey")+
geom_hline(yintercept=0)+
theme_bw()+
xlab(bquote(p))+
ylab("Density")
R <- 1000
resamples <- tibble(p.hat = numeric(R))
ggplot(resamples) +
geom_histogram(aes(x=p.hat, y=after_stat(density)),
color="grey")+
geom_hline(yintercept=0)+
geom_density(color = "red", linewidth = 1) +
theme_bw()+
xlab(bquote(p))+
ylab("Density")
ggplot(resamples) +
geom_histogram(aes(x=p.hat, y=after_stat(density)),
color="grey")+
geom_hline(yintercept=0)+
theme_bw()+
xlab(bquote(p))+
ylab("Density")
ggplot(resamples) +
geom_histogram(aes(x=p.hat, y=after_stat(density)),
color="grey")+
geom_hline(yintercept=0)+
theme_bw()+
xlab(bquote(p))+
ylab("Density")
ggplot(resamples) +
geom_histogram(aes(x=p.hat, y=after_stat(density)),
color="grey")+
geom_hline(yintercept=0)+
theme_bw()+
xlab(bquote(p))+
ylab("Density")
ggplot(resamples) +
geom_histogram(aes(x=, y=after_stat(density)),
breaks=seq(1.4, 2.7,0.10),
color="grey")+
geom_hline(yintercept=0)+
theme_bw()+
xlab(bquote(p))+
ylab("Density")
ggplot(resamples) +
geom_histogram(aes(x=p.hat, y=after_stat(density)),
breaks=seq(1.4, 2.7,0.10),
color="grey")+
geom_hline(yintercept=0)+
theme_bw()+
xlab(bquote(lambda))+
ylab("Density")
ggplot(resamples) +
geom_histogram(aes(x=p.hat, y=after_stat(density)),
color="grey")+
geom_hline(yintercept=0)+
theme_bw()+
xlab("p.hat")+
ylab("Density")
ggplot(resamples) +
geom_histogram(aes(x=p.hat, y=after_stat(density)),
color="grey")+
geom_hline(yintercept=0)+
xlab("p.hat")+
ylab("Density")
ggplot(resamples) +
geom_histogram(aes(x=p.hat, y=after_stat(density)),
color="grey")+
geom_hline(yintercept=0)+
xlab("p.hat")+
ylab("Density")
ggplot(resamples) +
geom_histogram(aes(x=p.hat, y=after_stat(density)),
bins = 30,
color="grey")+
geom_hline(yintercept=0)+
xlab("p.hat")+
ylab("Density")
ggplot(resamples) +
geom_histogram(aes(x=p.hat, y=after_stat(density)),
bins = 30,
color="grey")+
geom_hline(yintercept=0)+
xlab("p.hat")+
ylab("Density")
sim.study <- rbinom(n=10000, size=1000, prob=0.39) #Random binom sample
data <- tibble(x = sim.study)
R <- 1000
resamples <- tibble(p.hat = numeric(R))
for( i in 1:R){
curr.resample <- sample(x = data$x,
size = nrow(data),
replace = T)
# compute the stat on the resample
resamples$p.hat[i] <- mean(curr.resample)
}
library(tidyverse)
data <- tibble(x = sim.study)
resamples <- tibble(p.hat = numeric(R))
for( i in 1:R){
curr.resample <- sample(x = data$x,
size = nrow(data),
replace = T)
# compute the stat on the resample
resamples$p.hat[i] <- mean(curr.resample)
}
View(resamples)
View(data)
View(resamples)
View(resamples)
View(resamples)
resample.plot <- ggplot(resamples) +
geom_histogram(aes(x=p.hat, y=after_stat(density)),
color="grey")+
geom_hline(yintercept=0)+
xlab("p.hat")+
ylab("Density")
resample.plot
resample.plot <- ggplot(resamples) +
geom_histogram(aes(x=p.hat, y=after_stat(density)),
color="grey")+
geom_density(color = "red", linewidth = 1) +
labs(
x = "Value",
y = "Density"
) +
geom_hline(yintercept=0)+
xlab("p.hat")+
ylab("Density")
resample.plot
resample.plot <- ggplot(resamples, aes(x = p.hat)) +
geom_histogram(aes(y = after_stat(density)), binwidth = 0.01, color = "grey", fill = "white") +
geom_density(color = "red", linewidth = 1) +
geom_hline(yintercept = 0) +
labs(x = "p.hat", y = "Density")
resample.plot
n_values <- seq(100, 3000, by = 10)
p_values <- seq(0.01, 0.99, by = 0.01)
stored_values <- tibble(
n=numeric(),
p=numeric(),
p_hat=numeric(),
moe=numeric()
)
stored_values <- tibble(
n=numeric(),
p=numeric(),
p_hat=numeric(),
moe=numeric()
)
for (n in n_values) {
for (p in p_values) {
# Run 10,000 simulations and calculate p.hat = x/n
sim <- rbinom(n = 10000, size = n, prob = p) / n
# Store the results in a data frame
temp_df <- tibble(
n = n,
p = p,
p_hat = sim,
moe <- (quantile(p_hat, 0.975) - quantile(p_hat, 0.025)) / 2
)
stored_values <- rbind(stored_values, temp_df)
}
}
